#!/usr/bin/osascript -l JavaScript

function run() {
    const app = Application('OmniFocus');
    app.includeStandardAdditions = true;

    const doc = app.defaultDocument;
    const tags = doc.flattenedTags();

    const result = [];

    tags.forEach(tag => {
        result.push({
            id: tag.id(),
            name: tag.name(),
            available: tag.available()
        });
    });

    return JSON.stringify(result, null, 2);
}
